<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Shrimp Duel Prototype</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; }
    .grid {
      display: grid;
      grid-template-columns: repeat(8, 60px);
      grid-template-rows: repeat(8, 60px);
      gap: 2px;
      margin: 10px auto;
      width: max-content;
    }
    .cell {
      width: 60px; height: 60px;
      border: 1px solid #ccc;
      background: #f0f0f0;
      cursor: pointer;
      position: relative;
    }
    .cell.hit { background: #ff6b6b; }
    .cell.miss { background: #6ba8ff; }
    .shrimp {
      width: 100%; height: 100%;
      object-fit: contain;
    }
    #status { margin: 10px; font-weight: bold; }
    #timer { font-size: 18px; margin: 5px; }
  </style>
</head>
<body>

<h2>ü¶ê Shrimp Duel ‚Äì Prototype</h2>
<div id="status">Setup udangmu! (15s)</div>
<div id="timer"></div>

<h3>Papan Pemain 1</h3>
<div id="board1" class="grid"></div>

<h3>Papan Pemain 2</h3>
<div id="board2" class="grid"></div>

<script>
const SIZE = 8;
const shrimpImg = "IMG_20250911_224225.jpg"; // ganti dengan path gambar udangmu
let board1 = [], board2 = [];
let revealed1 = [], revealed2 = [];
let currentPhase = "setup"; // "setup" atau "battle"
let setupTime = 15, battleTime = 120;
let timer = setupTime;
let currentPlayer = 1;

// Inisialisasi papan
function createBoard(containerId, board, revealed) {
  const container = document.getElementById(containerId);
  for (let r=0; r<SIZE; r++) {
    board[r] = [];
    revealed[r] = [];
    for (let c=0; c<SIZE; c++) {
      const cell = document.createElement("div");
      cell.className = "cell";
      cell.dataset.row = r;
      cell.dataset.col = c;
      cell.onclick = () => handleClick(containerId, r, c);
      container.appendChild(cell);
      board[r][c] = 0;
      revealed[r][c] = false;
    }
  }
}

createBoard("board1", board1, revealed1);
createBoard("board2", board2, revealed2);

// Taruh udang (sementara random placement)
function placeShrimps(board) {
  const lengths = [4,3,2];
  lengths.forEach(len=>{
    let placed = false;
    while(!placed) {
      let row = Math.floor(Math.random()*SIZE);
      let col = Math.floor(Math.random()*SIZE);
      let horizontal = Math.random() > 0.5;
      let fits = true;
      for (let i=0;i<len;i++) {
        let rr = row + (horizontal?0:i);
        let cc = col + (horizontal?i:0);
        if (rr>=SIZE || cc>=SIZE || board[rr][cc]!==0) { fits=false; break; }
      }
      if (fits) {
        for (let i=0;i<len;i++) {
          let rr = row + (horizontal?0:i);
          let cc = col + (horizontal?i:0);
          board[rr][cc] = 1;
        }
        placed = true;
      }
    }
  });
}

placeShrimps(board1);
placeShrimps(board2);

// Handle klik
function handleClick(boardId, r, c) {
  if (currentPhase!=="battle") return;
  if ((boardId==="board2" && currentPlayer===1) ||
      (boardId==="board1" && currentPlayer===2)) {
    let board = (boardId==="board2")?board2:board1;
    let revealed = (boardId==="board2")?revealed2:revealed1;
    if (revealed[r][c]) return;
    revealed[r][c] = true;
    const cell = document.querySelector(`#${boardId} .cell[data-row="${r}"][data-col="${c}"]`);
    if (board[r][c]===1) {
      cell.classList.add("hit");
    } else {
      cell.classList.add("miss");
    }
    // ganti giliran
    currentPlayer = (currentPlayer===1)?2:1;
    document.getElementById("status").textContent = "Giliran Pemain "+currentPlayer;
  }
}

// Timer
function startTimer() {
  const timerDiv = document.getElementById("timer");
  const interval = setInterval(()=>{
    timer--;
    timerDiv.textContent = "‚è±Ô∏è "+timer+"s";
    if (timer<=0) {
      if (currentPhase==="setup") {
        currentPhase="battle";
        timer=battleTime;
        document.getElementById("status").textContent="Battle dimulai! Giliran Pemain 1";
      } else {
        clearInterval(interval);
        endGame();
      }
    }
  },1000);
}

function endGame() {
  let score1=0, score2=0;
  for (let r=0;r<SIZE;r++) {
    for (let c=0;c<SIZE;c++) {
      if (board2[r][c]===1 && revealed2[r][c]) score1++;
      if (board1[r][c]===1 && revealed1[r][c]) score2++;
    }
  }
  let winner="Seri!";
  if (score1>score2) winner="Pemain 1 menang!";
  if (score2>score1) winner="Pemain 2 menang!";
  document.getElementById("status").textContent =
    `‚è∞ Waktu habis! Skor: P1=${score1}, P2=${score2}. ${winner}`;
}

startTimer();
</script>

</body>
</html>
